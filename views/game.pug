html
    head
        script(src="/socket.io/socket.io.js")
        script(src="https://unpkg.com/alpinejs") 
        script(src="/scripts/game.js")
        link(href='https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css',
            rel="stylesheet",
            crossorigin="anonymous")
        title Play Bluff online
        style.
            .tooltip-wrapper .btn[disabled] {
                /* don't let button block mouse events from reaching wrapper */
                pointer-events: none;
            }

            .tooltip-wrapper.disabled {
                /* OPTIONAL pointer-events setting above blocks cursor setting, so set it here */
                cursor: not-allowed;
            }
    body
        div(id='wrapper', class="p-4 text-center")
            div(x-data="game()", x-init=`init(${player ? !!player.game : false})`)
                img(class="d-none" src="/images/dices.png" x-ref="dicesImage")
                img(class="d-none" src="/images/bubble.png" x-ref="bubbleImage")
                img(class="d-none" src="/images/cross.png" x-ref="crossImage")
                div(class='jumbotron text-center')
                    h1(class="text-primary") Bluff Online
                
                div(class="container mt-4 mb-4", x-show="gameState === 'set-username' || gameState === 'create-game' || gameState === 'join-game'")
                    h3 Create or Join a Game
                div(x-show="gameState === 'set-username'")
                    h4 Set Nickname
                    div
                        input(class="m-2", type="text", x-model="player.username")
                    div(class="row d-flex justify-content-center")
                        button(class="btn btn-primary m-2 col-md-2", @click="gameState = 'create-game'; connectSocketIO() ; authSocketIO()") Create
                        button(class="btn btn-primary m-2 col-md-2", @click="gameState = 'join-game'; connectSocketIO() ; authSocketIO()") Join
                    div(class="mt-5") If you choose to create or join a game you agree to have a cookie set on your browser
                
                div(x-show="gameState === 'create-game'")
                    h4 Create Game
                    div(class="row d-flex justify-content-center")
                        button(class="btn btn-warning m-2 col-md-2", @click="gameState = 'set-username'") Back
                        button(class="btn btn-success m-2 col-md-2", @click="createGame(this.loadGame)") Create
                div(x-show="gameState === 'join-game'")
                    h4 Join Game by Invite Code
                    div
                        input(class="m-2", type="text", x-model="game.inviteCode")
                    div(class="row d-flex justify-content-center")
                        button(class="btn btn-warning m-2 col-md-2", @click="gameState = 'set-username'") Back
                        button(class="btn btn-success m-2 col-md-2", @click="joinGame()") Join

                div(x-show="gameState === 'lobby'")
                    h4(x-text="'Invite Code: ' + game.inviteCode")
                    div(class="d-flex justify-content-center m-4")
                        div(class="border border-warning w-25")
                            h4 Players in Lobby
                            template(x-for="item in players" :key="item")
                                div(x-text="item.username" :class="{ 'border border-primary': item.isThisPlayer }")
                    button(class="btn btn-danger m-2" @click="leaveGame()") Leave
                    button(class="btn btn-success m-2" x-show="player.isAdmin && players.length >= 2" @click="startGame()") Start
                    span(class="tooltip-wrapper disabled" title="Not enough players (at least 2 required)" x-show="player.isAdmin && players.length < 2")
                        button(class="btn btn-success m-2" disabled) Start
                    span(class="tooltip-wrapper disabled" title="You are not the admin of the game" x-show="!player.isAdmin")
                        button(class="btn btn-success m-2" disabled) Start
                div(x-show="gameState === 'ingame'")
                    div(class="m-4")
                    div(class="text-center")
                        canvas(class="border border-primary" x-ref="gameCanvas" width="1200px" height="600px")
